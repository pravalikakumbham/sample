{"dataflow":{"dfKey":"12c2f116-555e-4d5f-bfc7-a245d039ac14","name":"sf_insertdata_09_06","tags":null,"description":null,"definition":"{\"name\":\"sf_insertdata_09_06\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"componentId\":1,\"componentName\":\"t_data_model\",\"tableName\":\"t_data_model\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"PostgreSQLRep\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"SELECT * from t_data_model WHERE container_id \\u003d $[container_id] and datasource_id!\\u003d0 and datasource_id is not null and is_deleted is null\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"componentId\":6,\"componentName\":\"t_dm_table_mapping\",\"tableName\":\"t_dm_table_mapping\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"PostgreSQLRep\",\"displayRows\":1000,\"dependencies\":[],\"options\":{\"dbTable\":\"select tdtm.* from t_dm_table_mapping as tdtm\\r\\njoin t_dm_table as tdt on tdt.table_id\\u003dtdtm.table_id\\r\\njoin t_data_model as tdm on tdtm.data_model_id\\u003dtdm.data_model_id \\r\\nwhere tdm.container_id\\u003d$[container_id] and tdm.datasource_id is not null\\r\\n\\r\\n\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"componentId\":21,\"componentName\":\"t_dm_table\",\"tableName\":\"t_dm_table\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"PostgreSQLRep\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select tdt.* from t_dm_table as tdt\\r\\njoin t_dm_table_mapping as tdtm\\r\\non tdt.table_id\\u003dtdtm.table_id\\r\\njoin t_data_model as tdm\\r\\non tdm.data_model_id\\u003dtdtm.data_model_id \\r\\nwhere tdm.container_id\\u003d$[container_id] and tdm.datasource_id is not null\\r\\n\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"componentId\":22,\"componentName\":\"t_dm_column\",\"tableName\":\"t_dm_column\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"PostgreSQLRep\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select tdc.* from t_dm_column as tdc\\r\\njoin t_dm_data_rule as tddr on \\r\\ntdc.column_id\\u003dtddr.column_id\\r\\njoin t_dm_table_mapping as tdtm\\r\\non tdtm.table_id \\u003d tdc.table_id\\r\\njoin t_data_model as tdm on tdm.data_model_id\\u003dtdtm.data_model_id\\r\\nwhere tdm.container_id\\u003d$[container_id] and tdm.datasource_id!\\u003d0 and tdm.datasource_id is not null\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"componentId\":23,\"componentName\":\"t_dm_data_rule\",\"tableName\":\"t_dm_data_rule\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"PostgreSQLRep\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select tdtr.* from t_dm_data_rule as tdtr\\r\\njoin t_dm_table_mapping as tdtm\\r\\non tdtm.table_id\\u003dtdtr.table_id\\r\\njoin t_data_model as tdm \\r\\non tdm.data_model_id\\u003dtdtm.data_model_id\\r\\nwhere tdm.container_id\\u003d$[container_id] and tdm.datasource_id is not null and tdm.datasource_id !\\u003d0\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"componentId\":24,\"componentName\":\"t_dm_run\",\"tableName\":\"t_dm_run\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"PostgreSQLRep\",\"displayRows\":1000,\"dependencies\":[],\"options\":{\"dbTable\":\"select tdr.* from t_dm_run as tdr\\r\\njoin t_data_model as tdm \\r\\non tdr.data_model_id\\u003dtdm.data_model_id\\r\\nwhere tdm.container_id\\u003d$[container_id] and tdm.datasource_id is not null\\r\\n\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"isAutoRepartition\":\"N\",\"databaseName\":\"\",\"failComponentWhenDatasetEmpty\":\"N\",\"componentId\":25,\"componentName\":\"t_dm_data_rule_run\",\"tableName\":\"t_dm_data_rule_run\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"PostgreSQLRep\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"SELECT trr.*\\r\\nFROM t_dm_data_rule_run trr\\r\\nJOIN t_dm_run dmrun ON trr.data_model_run_id \\u003d dmrun.data_model_run_id\\r\\nJOIN t_dm_data_rule rule ON trr.data_model_rule_id \\u003d rule.data_rule_id\\r\\nJOIN t_data_model dm ON dmrun.data_model_id \\u003d dm.data_model_id\\r\\nwhere dm.container_id \\u003d$[container_id] and dm.datasource_id is not null\\r\\n\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"schemaName\":\"DEMO_DB.PUBLIC\",\"sourceDataFrame\":\"t_dm_data_rule_run\",\"saveMode\":\"overwrite\",\"numPartitions\":0,\"mapping\":[{\"sourceColumn\":\"data_model_run_id\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"DATA_MODEL_RUN_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"data_model_rule_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATA_MODEL_RULE_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"data_model_rule_run_id\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"DATA_MODEL_RULE_RUN_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"rule_type\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RULE_TYPE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"status\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"STATUS\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"data_count\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"DATA_COUNT\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"result_count\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"RESULT_COUNT\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"validation_percentage\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"VALIDATION_PERCENTAGE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"severity\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"SEVERITY\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"sample_result\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"SAMPLE_RESULT\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"message\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"MESSAGE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"start_time\",\"sourceType\":\"timestamp\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"START_TIME\",\"targetType\":\"TIMESTAMP_NTZ\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"end_time\",\"sourceType\":\"timestamp\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"END_TIME\",\"targetType\":\"TIMESTAMP_NTZ\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"failure_criteria\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"FAILURE_CRITERIA\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"column_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"COLUMN_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"result_query\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RESULT_QUERY\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"data_query\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATA_QUERY\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"score\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"SCORE\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"bad_records_count\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"BAD_RECORDS_COUNT\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"table_name\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"TABLE_NAME\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"display_flag\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DISPLAY_FLAG\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"component_run_id\",\"sourceType\":\"integer\",\"originalSourceType\":\"integer\",\"targetColumn\":\"COMPONENT_RUN_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"result_count_query\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RESULT_COUNT_QUERY\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"bad_file_location\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"BAD_FILE_LOCATION\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"is_valid\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_VALID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"additional_options\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"ADDITIONAL_OPTIONS\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"}],\"componentId\":39,\"componentName\":\"t_dm_data_rule_run_staging\",\"tableName\":\"T_DM_DATA_RULE_RUN_STAGING\",\"category\":\"Sink\",\"componentType\":\"DB sink\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":0,\"dependencies\":[25],\"options\":{\"numPartitions\":\"4\",\"batchsize\":\"1000\"},\"className\":\"com.datagaps.dataflow.models.DBSyncComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"schemaName\":\"DEMO_DB.PUBLIC\",\"sourceDataFrame\":\"t_dm_run\",\"saveMode\":\"overwrite\",\"numPartitions\":0,\"mapping\":[{\"sourceColumn\":\"data_model_run_id\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"DATA_MODEL_RUN_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"data_model_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATA_MODEL_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"start_time\",\"sourceType\":\"timestamp\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"START_TIME\",\"targetType\":\"TIMESTAMP_NTZ\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"end_time\",\"sourceType\":\"timestamp\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"END_TIME\",\"targetType\":\"TIMESTAMP_NTZ\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"status\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"STATUS\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"runtag\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RUNTAG\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"parallel_rule_count\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"PARALLEL_RULE_COUNT\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"datasource_id\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"DATASOURCE_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"message\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"MESSAGE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"table_group_id\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"TABLE_GROUP_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"user_id\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"USER_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"additional_option\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"ADDITIONAL_OPTION\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"type\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"TYPE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"}],\"componentId\":38,\"componentName\":\"t_dm_run_staging\",\"tableName\":\"T_DM_RUN_STAGING\",\"category\":\"Sink\",\"componentType\":\"DB sink\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":0,\"dependencies\":[24],\"options\":{\"numPartitions\":\"4\",\"batchsize\":\"1000\"},\"className\":\"com.datagaps.dataflow.models.DBSyncComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"schemaName\":\"DEMO_DB.PUBLIC\",\"sourceDataFrame\":\"t_dm_data_rule\",\"saveMode\":\"overwrite\",\"numPartitions\":0,\"mapping\":[{\"sourceColumn\":\"data_rule_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATA_RULE_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"business_rule_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"BUSINESS_RULE_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"table_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"TABLE_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"column_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"COLUMN_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"rule_type\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RULE_TYPE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"rule_name\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RULE_NAME\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"definition\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DEFINITION\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"description\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DESCRIPTION\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"rule_order\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"RULE_ORDER\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"updated_by\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"UPDATED_BY\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"dq_dimension\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DQ_DIMENSION\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"severity\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"SEVERITY\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"updated_dt\",\"sourceType\":\"timestamp\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"UPDATED_DT\",\"targetType\":\"TIMESTAMP_NTZ\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"is_active\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_ACTIVE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"is_deleted\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_DELETED\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"deleted_level\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DELETED_LEVEL\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"curr_metadata\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"CURR_METADATA\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"prev_metadata\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"PREV_METADATA\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"component_id\",\"sourceType\":\"decimal(38,18)\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"COMPONENT_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"imported_from_rule_id\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"IMPORTED_FROM_RULE_ID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"rule_category\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RULE_CATEGORY\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"is_valid\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_VALID\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"rule_key\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"RULE_KEY\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"mapping_type\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"MAPPING_TYPE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"}],\"componentId\":37,\"componentName\":\"t_dm_data_rule_staging\",\"tableName\":\"T_DM_DATA_RULE_STAGING\",\"category\":\"Sink\",\"componentType\":\"DB sink\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":0,\"dependencies\":[23],\"options\":{\"numPartitions\":\"4\",\"batchsize\":\"1000\"},\"className\":\"com.datagaps.dataflow.models.DBSyncComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"schemaName\":\"DEMO_DB.PUBLIC\",\"sourceDataFrame\":\"t_dm_column\",\"saveMode\":\"overwrite\",\"numPartitions\":0,\"mapping\":[{\"sourceColumn\":\"column_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"COLUMN_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"table_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"TABLE_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"attribute_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"ATTRIBUTE_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"column_name\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"COLUMN_NAME\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"description\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DESCRIPTION\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"data_type\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATA_TYPE\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"domain_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DOMAIN_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"updated_by\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"UPDATED_BY\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"updated_dt\",\"sourceType\":\"timestamp\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"UPDATED_DT\",\"targetType\":\"TIMESTAMP_NTZ\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"is_null\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_NULL\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"is_deleted\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_DELETED\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"deleted_level\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DELETED_LEVEL\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"entity_id\",\"sourceType\":\"integer\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"integer\",\"targetColumn\":\"ENTITY_ID\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"column_length\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"COLUMN_LENGTH\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"column_alias\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"COLUMN_ALIAS\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"column_order\",\"sourceType\":\"integer\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"integer\",\"targetColumn\":\"COLUMN_ORDER\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"column_precision\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"COLUMN_PRECISION\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"imported_from_column_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IMPORTED_FROM_COLUMN_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"additional_info\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"ADDITIONAL_INFO\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"}],\"componentId\":36,\"componentName\":\"t_dm_column_staging\",\"tableName\":\"T_DM_COLUMN_STAGING\",\"category\":\"Sink\",\"componentType\":\"DB sink\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":0,\"dependencies\":[22],\"options\":{\"numPartitions\":\"4\",\"batchsize\":\"1000\"},\"className\":\"com.datagaps.dataflow.models.DBSyncComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"schemaName\":\"DEMO_DB.PUBLIC\",\"sourceDataFrame\":\"t_dm_table\",\"saveMode\":\"overwrite\",\"numPartitions\":0,\"mapping\":[{\"sourceColumn\":\"table_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"TABLE_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"schema_name\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"SCHEMA_NAME\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"table_name\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"TABLE_NAME\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"description\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DESCRIPTION\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"updated_by\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"UPDATED_BY\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"updated_dt\",\"sourceType\":\"timestamp\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"UPDATED_DT\",\"targetType\":\"TIMESTAMP_NTZ\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"is_deleted\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_DELETED\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"deleted_level\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DELETED_LEVEL\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"sampledata_settings_json\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"SAMPLEDATA_SETTINGS_JSON\",\"targetType\":\"VARIANT\",\"orginalTargetType\":\"VARIANT\"},{\"sourceColumn\":\"datasource_type\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATASOURCE_TYPE\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"datasource_id\",\"sourceType\":\"integer\",\"originalSourceType\":\"integer\",\"targetColumn\":\"DATASOURCE_ID\",\"targetType\":\"NUMBER\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"unique_columns\",\"sourceType\":\"string\",\"originalSourceType\":\"string\",\"targetColumn\":\"UNIQUE_COLUMNS\",\"targetType\":\"TEXT\",\"orginalTargetType\":\"TEXT\"}],\"componentId\":35,\"componentName\":\"t_dm_table_staging\",\"tableName\":\"T_DM_TABLE_STAGING\",\"category\":\"Sink\",\"componentType\":\"DB sink\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":0,\"dependencies\":[21],\"options\":{\"numPartitions\":\"4\",\"batchsize\":\"1000\"},\"className\":\"com.datagaps.dataflow.models.DBSyncComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"schemaName\":\"DEMO_DB.PUBLIC\",\"sourceDataFrame\":\"t_dm_table_mapping\",\"saveMode\":\"overwrite\",\"numPartitions\":0,\"mapping\":[{\"sourceColumn\":\"mapping_id\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"MAPPING_ID\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"data_model_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATA_MODEL_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"table_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"TABLE_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"imported_from_table_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IMPORTED_FROM_TABLE_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"}],\"componentId\":34,\"componentName\":\"t_dm_table_mapping_staging\",\"tableName\":\"T_DM_TABLE_MAPPING_STAGING\",\"category\":\"Sink\",\"componentType\":\"DB sink\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":0,\"dependencies\":[6],\"options\":{\"numPartitions\":\"4\",\"batchsize\":\"1000\"},\"className\":\"com.datagaps.dataflow.models.DBSyncComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"schemaName\":\"DEMO_DB.PUBLIC\",\"sourceDataFrame\":\"t_data_model\",\"saveMode\":\"overwrite\",\"numPartitions\":0,\"mapping\":[{\"sourceColumn\":\"data_model_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DATA_MODEL_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"name\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"NAME\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"description\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DESCRIPTION\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"datasource_id\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"DATASOURCE_ID\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"container_id\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"CONTAINER_ID\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"updated_by\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"UPDATED_BY\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"updated_dt\",\"sourceType\":\"timestamp\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"timestamp\",\"targetColumn\":\"UPDATED_DT\",\"targetType\":\"TIMESTAMP_NTZ\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TIMESTAMP_NTZ\"},{\"sourceColumn\":\"is_deleted\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IS_DELETED\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"workschema_id\",\"sourceType\":\"decimal(38,18)\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"decimal(38,18)\",\"targetColumn\":\"WORKSCHEMA_ID\",\"targetType\":\"NUMBER\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"NUMBER\"},{\"sourceColumn\":\"df_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DF_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"imported_from_dm_id\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"IMPORTED_FROM_DM_ID\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"dm_key\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"DM_KEY\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"additional_info\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"ADDITIONAL_INFO\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"},{\"sourceColumn\":\"type\",\"sourceType\":\"string\",\"sourceDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"originalSourceType\":\"string\",\"targetColumn\":\"TYPE\",\"targetType\":\"TEXT\",\"targetDataFormat\":\"\",\"targetTypeChange\":\"N\",\"orginalTargetType\":\"TEXT\"}],\"componentId\":33,\"componentName\":\"t_data_model_staging\",\"tableName\":\"T_DATA_MODEL_STAGING\",\"category\":\"Sink\",\"componentType\":\"DB sink\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":0,\"dependencies\":[1],\"options\":{\"numPartitions\":\"4\",\"batchsize\":\"1000\"},\"className\":\"com.datagaps.dataflow.models.DBSyncComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"dbScripts\":[{\"script\":\"MERGE INTO t_data_model AS target\\r\\nUSING (\\r\\n    SELECT *\\r\\n    FROM (\\r\\n        SELECT *,\\r\\n               ROW_NUMBER() OVER (\\r\\n                   PARTITION BY data_model_id\\r\\n                   ORDER BY updated_dt DESC  -- keep latest per data_model_id\\r\\n               ) AS rn\\r\\n        FROM t_data_model_staging\\r\\n    ) sub\\r\\n    WHERE rn \\u003d 1  -- pick only the latest record per data_model_id\\r\\n) AS source\\r\\nON target.data_model_id \\u003d source.data_model_id\\r\\n\\r\\nWHEN MATCHED THEN\\r\\n    UPDATE SET\\r\\n        target.name                \\u003d source.name,\\r\\n        target.description         \\u003d source.description,\\r\\n        target.datasource_id       \\u003d source.datasource_id,\\r\\n        target.container_id        \\u003d source.container_id,\\r\\n        target.updated_by          \\u003d source.updated_by,\\r\\n        target.updated_dt          \\u003d source.updated_dt,\\r\\n        target.is_deleted          \\u003d source.is_deleted,\\r\\n        target.workschema_id       \\u003d source.workschema_id,\\r\\n        target.df_id               \\u003d source.df_id,\\r\\n        target.imported_from_dm_id \\u003d source.imported_from_dm_id,\\r\\n        target.dm_key              \\u003d source.dm_key,\\r\\n        target.additional_info     \\u003d source.additional_info,\\r\\n        target.type                \\u003d source.type\\r\\n\\r\\nWHEN NOT MATCHED THEN\\r\\n    INSERT (\\r\\n        data_model_id,\\r\\n        name,\\r\\n        description,\\r\\n        datasource_id,\\r\\n        container_id,\\r\\n        updated_by,\\r\\n        updated_dt,\\r\\n        is_deleted,\\r\\n        workschema_id,\\r\\n        df_id,\\r\\n        imported_from_dm_id,\\r\\n        dm_key,\\r\\n        additional_info,\\r\\n        type\\r\\n    )\\r\\n    VALUES (\\r\\n        source.data_model_id,\\r\\n        source.name,\\r\\n        source.description,\\r\\n        source.datasource_id,\\r\\n        source.container_id,\\r\\n        source.updated_by,\\r\\n        source.updated_dt,\\r\\n        source.is_deleted,\\r\\n        source.workschema_id,\\r\\n        source.df_id,\\r\\n        source.imported_from_dm_id,\\r\\n        source.dm_key,\\r\\n        source.additional_info,\\r\\n        source.type\\r\\n    );\\r\\n\",\"executionOrder\":1,\"title\":\"\"},{\"script\":\"MERGE INTO t_dm_table_mapping AS target\\r\\nUSING (\\r\\n    SELECT *\\r\\n    FROM (\\r\\n        SELECT *,\\r\\n               ROW_NUMBER() OVER (\\r\\n                   PARTITION BY mapping_id\\r\\n                   ORDER BY data_model_id, table_id  -- or use updated_dt DESC if available\\r\\n               ) AS rn\\r\\n        FROM t_dm_table_mapping_staging\\r\\n    ) AS sub\\r\\n    WHERE rn \\u003d 1\\r\\n) AS source\\r\\nON target.mapping_id \\u003d source.mapping_id  -- make sure mapping_id is unique in target\\r\\n\\r\\nWHEN MATCHED THEN\\r\\n    UPDATE SET\\r\\n        target.data_model_id          \\u003d source.data_model_id,\\r\\n        target.table_id               \\u003d source.table_id,\\r\\n        target.imported_from_table_id \\u003d source.imported_from_table_id\\r\\n\\r\\nWHEN NOT MATCHED THEN\\r\\n    INSERT (\\r\\n        mapping_id,\\r\\n        data_model_id,\\r\\n        table_id,\\r\\n        imported_from_table_id\\r\\n    )\\r\\n    VALUES (\\r\\n        source.mapping_id,\\r\\n        source.data_model_id,\\r\\n        source.table_id,\\r\\n        source.imported_from_table_id\\r\\n    );\\r\\n\",\"executionOrder\":2,\"title\":\"\"},{\"script\":\"MERGE INTO t_dm_table AS target\\r\\nUSING (\\r\\n    SELECT *\\r\\n    FROM (\\r\\n        SELECT *,\\r\\n               ROW_NUMBER() OVER (\\r\\n                   PARTITION BY table_id\\r\\n                   ORDER BY updated_dt DESC  -- keeps only the latest per table_id\\r\\n               ) AS rn\\r\\n        FROM t_dm_table_staging\\r\\n    ) AS staged\\r\\n    WHERE rn \\u003d 1\\r\\n) AS source\\r\\nON target.table_id \\u003d source.table_id\\r\\n\\r\\nWHEN MATCHED THEN\\r\\n    UPDATE SET\\r\\n        target.schema_name              \\u003d source.schema_name,\\r\\n        target.table_name               \\u003d source.table_name,\\r\\n        target.description              \\u003d source.description,\\r\\n        target.updated_by               \\u003d source.updated_by,\\r\\n        target.updated_dt               \\u003d source.updated_dt,\\r\\n        target.is_deleted               \\u003d source.is_deleted,\\r\\n        target.deleted_level            \\u003d source.deleted_level,\\r\\n        target.sampledata_settings_json \\u003d source.sampledata_settings_json,\\r\\n        target.datasource_type          \\u003d source.datasource_type,\\r\\n        target.datasource_id            \\u003d source.datasource_id,\\r\\n        target.unique_columns           \\u003d source.unique_columns\\r\\n\\r\\nWHEN NOT MATCHED THEN\\r\\n    INSERT (\\r\\n        table_id,\\r\\n        schema_name,\\r\\n        table_name,\\r\\n        description,\\r\\n        updated_by,\\r\\n        updated_dt,\\r\\n        is_deleted,\\r\\n        deleted_level,\\r\\n        sampledata_settings_json,\\r\\n        datasource_type,\\r\\n        datasource_id,\\r\\n        unique_columns\\r\\n    )\\r\\n    VALUES (\\r\\n        source.table_id,\\r\\n        source.schema_name,\\r\\n        source.table_name,\\r\\n        source.description,\\r\\n        source.updated_by,\\r\\n        source.updated_dt,\\r\\n        source.is_deleted,\\r\\n        source.deleted_level,\\r\\n        source.sampledata_settings_json,\\r\\n        source.datasource_type,\\r\\n        source.datasource_id,\\r\\n        source.unique_columns\\r\\n    );\\r\\n\",\"executionOrder\":3,\"title\":\"\"},{\"script\":\"MERGE INTO t_dm_column AS target\\r\\nUSING (\\r\\n    SELECT *\\r\\n    FROM (\\r\\n        SELECT *,\\r\\n               ROW_NUMBER() OVER (\\r\\n                   PARTITION BY table_id, column_name\\r\\n                   ORDER BY updated_dt DESC  -- pick the most recent one\\r\\n               ) AS rn\\r\\n        FROM t_dm_column_staging\\r\\n    ) AS staged\\r\\n    WHERE rn \\u003d 1\\r\\n) AS source\\r\\nON target.table_id \\u003d source.table_id AND target.column_name \\u003d source.column_name\\r\\n\\r\\nWHEN MATCHED THEN\\r\\n    UPDATE SET\\r\\n        target.column_id               \\u003d source.column_id,\\r\\n        target.attribute_id            \\u003d source.attribute_id,\\r\\n        target.description             \\u003d source.description,\\r\\n        target.data_type               \\u003d source.data_type,\\r\\n        target.domain_id               \\u003d source.domain_id,\\r\\n        target.updated_by              \\u003d source.updated_by,\\r\\n        target.updated_dt              \\u003d source.updated_dt,\\r\\n        target.is_null                 \\u003d source.is_null,\\r\\n        target.is_deleted              \\u003d source.is_deleted,\\r\\n        target.deleted_level           \\u003d source.deleted_level,\\r\\n        target.entity_id               \\u003d source.entity_id,\\r\\n        target.column_length           \\u003d source.column_length,\\r\\n        target.column_alias            \\u003d source.column_alias,\\r\\n        target.column_order            \\u003d source.column_order,\\r\\n        target.column_precision        \\u003d source.column_precision,\\r\\n        target.imported_from_column_id \\u003d source.imported_from_column_id,\\r\\n        target.additional_info         \\u003d source.additional_info\\r\\n\\r\\nWHEN NOT MATCHED THEN\\r\\n    INSERT (\\r\\n        column_id,\\r\\n        table_id,\\r\\n        attribute_id,\\r\\n        column_name,\\r\\n        description,\\r\\n        data_type,\\r\\n        domain_id,\\r\\n        updated_by,\\r\\n        updated_dt,\\r\\n        is_null,\\r\\n        is_deleted,\\r\\n        deleted_level,\\r\\n        entity_id,\\r\\n        column_length,\\r\\n        column_alias,\\r\\n        column_order,\\r\\n        column_precision,\\r\\n        imported_from_column_id,\\r\\n        additional_info\\r\\n    )\\r\\n    VALUES (\\r\\n        source.column_id,\\r\\n        source.table_id,\\r\\n        source.attribute_id,\\r\\n        source.column_name,\\r\\n        source.description,\\r\\n        source.data_type,\\r\\n        source.domain_id,\\r\\n        source.updated_by,\\r\\n        source.updated_dt,\\r\\n        source.is_null,\\r\\n        source.is_deleted,\\r\\n        source.deleted_level,\\r\\n        source.entity_id,\\r\\n        source.column_length,\\r\\n        source.column_alias,\\r\\n        source.column_order,\\r\\n        source.column_precision,\\r\\n        source.imported_from_column_id,\\r\\n        source.additional_info\\r\\n    );\\r\\n\",\"executionOrder\":4,\"title\":\"\"},{\"script\":\"MERGE INTO t_dm_data_rule AS target\\r\\nUSING (\\r\\n    SELECT *\\r\\n    FROM (\\r\\n        SELECT *,\\r\\n               ROW_NUMBER() OVER (\\r\\n                   PARTITION BY data_rule_id\\r\\n                   ORDER BY updated_dt DESC  -- pick the most recent per data_rule_id\\r\\n               ) AS rn\\r\\n        FROM t_dm_data_rule_staging\\r\\n    ) AS deduped\\r\\n    WHERE rn \\u003d 1\\r\\n) AS source\\r\\nON target.data_rule_id \\u003d source.data_rule_id\\r\\n\\r\\nWHEN MATCHED THEN\\r\\n    UPDATE SET\\r\\n        target.business_rule_id       \\u003d source.business_rule_id,\\r\\n        target.table_id               \\u003d source.table_id,\\r\\n        target.column_id              \\u003d source.column_id,\\r\\n        target.rule_type              \\u003d source.rule_type,\\r\\n        target.rule_name              \\u003d source.rule_name,\\r\\n        target.definition             \\u003d source.definition,\\r\\n        target.description            \\u003d source.description,\\r\\n        target.rule_order             \\u003d source.rule_order,\\r\\n        target.updated_by             \\u003d source.updated_by,\\r\\n        target.dq_dimension           \\u003d source.dq_dimension,\\r\\n        target.severity               \\u003d source.severity,\\r\\n        target.updated_dt             \\u003d source.updated_dt,\\r\\n        target.is_active              \\u003d source.is_active,\\r\\n        target.is_deleted             \\u003d source.is_deleted,\\r\\n        target.deleted_level          \\u003d source.deleted_level,\\r\\n        target.curr_metadata          \\u003d source.curr_metadata,\\r\\n        target.prev_metadata          \\u003d source.prev_metadata,\\r\\n        target.component_id           \\u003d source.component_id,\\r\\n        target.imported_from_rule_id  \\u003d source.imported_from_rule_id,\\r\\n        target.rule_category          \\u003d source.rule_category,\\r\\n        target.is_valid               \\u003d source.is_valid,\\r\\n        target.rule_key               \\u003d source.rule_key,\\r\\n        target.mapping_type           \\u003d source.mapping_type\\r\\n\\r\\nWHEN NOT MATCHED THEN\\r\\n    INSERT (\\r\\n        data_rule_id,\\r\\n        business_rule_id,\\r\\n        table_id,\\r\\n        column_id,\\r\\n        rule_type,\\r\\n        rule_name,\\r\\n        definition,\\r\\n        description,\\r\\n        rule_order,\\r\\n        updated_by,\\r\\n        dq_dimension,\\r\\n        severity,\\r\\n        updated_dt,\\r\\n        is_active,\\r\\n        is_deleted,\\r\\n        deleted_level,\\r\\n        curr_metadata,\\r\\n        prev_metadata,\\r\\n        component_id,\\r\\n        imported_from_rule_id,\\r\\n        rule_category,\\r\\n        is_valid,\\r\\n        rule_key,\\r\\n        mapping_type\\r\\n    )\\r\\n    VALUES (\\r\\n        source.data_rule_id,\\r\\n        source.business_rule_id,\\r\\n        source.table_id,\\r\\n        source.column_id,\\r\\n        source.rule_type,\\r\\n        source.rule_name,\\r\\n        source.definition,\\r\\n        source.description,\\r\\n        source.rule_order,\\r\\n        source.updated_by,\\r\\n        source.dq_dimension,\\r\\n        source.severity,\\r\\n        source.updated_dt,\\r\\n        source.is_active,\\r\\n        source.is_deleted,\\r\\n        source.deleted_level,\\r\\n        source.curr_metadata,\\r\\n        source.prev_metadata,\\r\\n        source.component_id,\\r\\n        source.imported_from_rule_id,\\r\\n        source.rule_category,\\r\\n        source.is_valid,\\r\\n        source.rule_key,\\r\\n        source.mapping_type\\r\\n    );\\r\\n\",\"executionOrder\":5,\"title\":\"\"},{\"script\":\"MERGE INTO t_dm_run AS target\\r\\nUSING (\\r\\n    SELECT *\\r\\n    FROM (\\r\\n        SELECT *,\\r\\n               ROW_NUMBER() OVER (\\r\\n                   PARTITION BY data_model_run_id\\r\\n                   ORDER BY start_time DESC\\r\\n               ) AS rn\\r\\n        FROM t_dm_run_staging\\r\\n    ) AS deduped\\r\\n    WHERE rn \\u003d 1\\r\\n) AS source\\r\\nON target.data_model_run_id \\u003d source.data_model_run_id\\r\\n\\r\\nWHEN MATCHED THEN\\r\\n    UPDATE SET\\r\\n        target.data_model_id       \\u003d source.data_model_id,\\r\\n        target.start_time          \\u003d source.start_time,\\r\\n        target.end_time            \\u003d source.end_time,\\r\\n        target.status              \\u003d source.status,\\r\\n        target.runtag              \\u003d source.runtag,\\r\\n        target.parallel_rule_count \\u003d source.parallel_rule_count,\\r\\n        target.datasource_id       \\u003d source.datasource_id,\\r\\n        target.message             \\u003d source.message,\\r\\n        target.table_group_id      \\u003d source.table_group_id,\\r\\n        target.user_id             \\u003d source.user_id,\\r\\n        target.additional_option   \\u003d source.additional_option,\\r\\n        target.type                \\u003d source.type\\r\\n\\r\\nWHEN NOT MATCHED THEN\\r\\n    INSERT (\\r\\n        data_model_run_id,\\r\\n        data_model_id,\\r\\n        start_time,\\r\\n        end_time,\\r\\n        status,\\r\\n        runtag,\\r\\n        parallel_rule_count,\\r\\n        datasource_id,\\r\\n        message,\\r\\n        table_group_id,\\r\\n        user_id,\\r\\n        additional_option,\\r\\n        type\\r\\n    )\\r\\n    VALUES (\\r\\n        source.data_model_run_id,\\r\\n        source.data_model_id,\\r\\n        source.start_time,\\r\\n        source.end_time,\\r\\n        source.status,\\r\\n        source.runtag,\\r\\n        source.parallel_rule_count,\\r\\n        source.datasource_id,\\r\\n        source.message,\\r\\n        source.table_group_id,\\r\\n        source.user_id,\\r\\n        source.additional_option,\\r\\n        source.type\\r\\n    );\\r\\n\",\"executionOrder\":6,\"title\":\"\"},{\"script\":\"MERGE INTO t_dm_data_rule_run AS target\\r\\nUSING (\\r\\n    SELECT *\\r\\n    FROM (\\r\\n        SELECT *,\\r\\n               ROW_NUMBER() OVER (\\r\\n                   PARTITION BY data_model_rule_run_id\\r\\n                   ORDER BY start_time DESC  -- or end_time DESC, whichever makes sense\\r\\n               ) AS rn\\r\\n        FROM t_dm_data_rule_run_staging\\r\\n    ) AS deduped\\r\\n    WHERE rn \\u003d 1\\r\\n) AS source\\r\\nON target.data_model_rule_run_id \\u003d source.data_model_rule_run_id\\r\\n\\r\\nWHEN MATCHED THEN\\r\\n    UPDATE SET\\r\\n        target.data_model_run_id      \\u003d source.data_model_run_id,\\r\\n        target.data_model_rule_id     \\u003d source.data_model_rule_id,\\r\\n        target.rule_type              \\u003d source.rule_type,\\r\\n        target.status                 \\u003d source.status,\\r\\n        target.data_count             \\u003d source.data_count,\\r\\n        target.result_count           \\u003d source.result_count,\\r\\n        target.validation_percentage  \\u003d source.validation_percentage,\\r\\n        target.severity               \\u003d source.severity,\\r\\n        target.sample_result          \\u003d source.sample_result,\\r\\n        target.message                \\u003d source.message,\\r\\n        target.start_time             \\u003d source.start_time,\\r\\n        target.end_time               \\u003d source.end_time,\\r\\n        target.failure_criteria       \\u003d source.failure_criteria,\\r\\n        target.column_id              \\u003d source.column_id,\\r\\n        target.result_query           \\u003d source.result_query,\\r\\n        target.data_query             \\u003d source.data_query,\\r\\n        target.score                  \\u003d source.score,\\r\\n        target.bad_records_count      \\u003d source.bad_records_count,\\r\\n        target.table_name             \\u003d source.table_name,\\r\\n        target.display_flag           \\u003d source.display_flag,\\r\\n        target.component_run_id       \\u003d source.component_run_id,\\r\\n        target.result_count_query     \\u003d source.result_count_query,\\r\\n        target.bad_file_location      \\u003d source.bad_file_location,\\r\\n        target.is_valid               \\u003d source.is_valid,\\r\\n        target.additional_options     \\u003d source.additional_options\\r\\n\\r\\nWHEN NOT MATCHED THEN\\r\\n    INSERT (\\r\\n        data_model_run_id,\\r\\n        data_model_rule_id,\\r\\n        data_model_rule_run_id,\\r\\n        rule_type,\\r\\n        status,\\r\\n        data_count,\\r\\n        result_count,\\r\\n        validation_percentage,\\r\\n        severity,\\r\\n        sample_result,\\r\\n        message,\\r\\n        start_time,\\r\\n        end_time,\\r\\n        failure_criteria,\\r\\n        column_id,\\r\\n        result_query,\\r\\n        data_query,\\r\\n        score,\\r\\n        bad_records_count,\\r\\n        table_name,\\r\\n        display_flag,\\r\\n        component_run_id,\\r\\n        result_count_query,\\r\\n        bad_file_location,\\r\\n        is_valid,\\r\\n        additional_options\\r\\n    )\\r\\n    VALUES (\\r\\n        source.data_model_run_id,\\r\\n        source.data_model_rule_id,\\r\\n        source.data_model_rule_run_id,\\r\\n        source.rule_type,\\r\\n        source.status,\\r\\n        source.data_count,\\r\\n        source.result_count,\\r\\n        source.validation_percentage,\\r\\n        source.severity,\\r\\n        source.sample_result,\\r\\n        source.message,\\r\\n        source.start_time,\\r\\n        source.end_time,\\r\\n        source.failure_criteria,\\r\\n        source.column_id,\\r\\n        source.result_query,\\r\\n        source.data_query,\\r\\n        source.score,\\r\\n        source.bad_records_count,\\r\\n        source.table_name,\\r\\n        source.display_flag,\\r\\n        source.component_run_id,\\r\\n        source.result_count_query,\\r\\n        source.bad_file_location,\\r\\n        source.is_valid,\\r\\n        source.additional_options\\r\\n    );\\r\\n\",\"executionOrder\":7,\"title\":\"\"}],\"componentId\":32,\"componentName\":\"SF_Target_data_insertion\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"DB script\",\"rank\":0,\"dataSourceName\":\"Snowflake_Test\",\"displayRows\":50,\"dependencies\":[33,34,35,36,37,38,39],\"className\":\"com.datagaps.dataflow.models.DBScriptComponent\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"type\":\"static\",\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":49,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow/SF_Tables","workSchemaName":null,"diagramSchema":"{\"isCustom\":false,\"diagramDef\":[]}"},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[],"filterDatasetMappings":[],"referenceDatasets":null}