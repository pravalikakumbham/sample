{"dataflow":{"dfKey":"9e21e059-93a2-4d03-882d-83767076b005","name":"Dataflow_4268","tags":null,"description":null,"definition":"{\"name\":\"Dataflow_4268\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"code\":\"spark.stop()\\r\\nfrom pyspark.sql import SparkSession\\r\\n\\r\\nspark \\u003d (\\r\\n    SparkSession.builder\\r\\n    .appName(\\\"CleanSession\\\")\\r\\n    .getOrCreate()\\r\\n)\\r\\nspark.sql(\\\"SHOW CATALOGS\\\").show()\\r\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"hideDatasets\":\"N\",\"componentId\":1,\"componentName\":\"Code 1\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"pluginId\":\"023cafb3-2188-4f77-ae0a-aef5983175c0\",\"pluginName\":\"Read Iceberg tables using hadoop\",\"pluginOptions\":{\"parameters\":[{\"parameterId\":\"87fcbc33-8f50-45d2-b8a2-ed2d9880a9c7\",\"fieldName\":\"catalog_name\",\"displayName\":\"Provide the catalog name\",\"value\":\"new_catalog\",\"dataType\":\"String\"},{\"parameterId\":\"6c0f12dc-77b4-458d-b5a0-c23d8fae5e61\",\"fieldName\":\"database_name\",\"displayName\":\"Provide the database name\",\"value\":\"pareto_db\",\"dataType\":\"String\"},{\"parameterId\":\"17b8ab78-c877-40c4-adc7-a7091090600e\",\"fieldName\":\"table_name\",\"displayName\":\"Provide the table name\",\"value\":\"paretojob2\",\"dataType\":\"String\"},{\"parameterId\":\"87f407a0-7c7d-4e1f-adaf-e339964461fb\",\"fieldName\":\"warehouse_path\",\"displayName\":\"Provide the warehouse path\",\"value\":\"s3a://datagapsqa1-target/amazon-glue-pareto/pareto-parquet-iceburg\",\"dataType\":\"String\"},{\"parameterId\":\"c0592f89-c2dd-4c11-86c1-8b23057bb35f\",\"fieldName\":\"aws_access_key\",\"displayName\":\"Provide the vault key for aws access key\",\"value\":\"aws_access_key\",\"dataType\":\"String\"},{\"parameterId\":\"ca8237a6-69ef-473e-a3bc-ab8b43530ccc\",\"fieldName\":\"aws_secret_key\",\"displayName\":\"Provide the vault key for aws secret key\",\"value\":\"aws_secret_key\",\"dataType\":\"String\"},{\"parameterId\":\"aef10b07-037c-4d1b-b005-419040848732\",\"fieldName\":\"s3_endpoint\",\"displayName\":\"Provide the s3 endpoint\",\"value\":\"s3.ap-south-1.amazonaws.com\",\"dataType\":\"String\"}],\"inputDatasets\":[],\"outputDatasets\":[],\"dataSources\":[],\"additionalProps\":[]},\"hideDatasets\":\"N\",\"componentId\":2,\"componentName\":\"Read Tables from Glue\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Plugin\",\"rank\":0,\"displayRows\":0,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.PluginComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"from pyspark.sql import SparkSession\\r\\n\\r\\ncatalog_name \\u003d \\\"s3_catalog\\\"\\r\\nwarehouse_path \\u003d \\\"s3a://datagapsqa1-target/amazon-glue-pareto/pareto-parquet-iceburg\\\"\\r\\ndatabase_name \\u003d \\\"pareto_db\\\"\\r\\ntable_name \\u003d \\\"paretojob2\\\"\\r\\n\\r\\nspark \\u003d (\\r\\n    SparkSession.builder\\r\\n    .appName(\\\"IcebergSession\\\")\\r\\n    .config(\\\"spark.sql.extensions\\\", \\\"org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\\\")\\r\\n    .config(f\\\"spark.sql.catalog.{catalog_name}\\\", \\\"org.apache.iceberg.spark.SparkCatalog\\\")\\r\\n    .config(f\\\"spark.sql.catalog.{catalog_name}.catalog-impl\\\", \\\"org.apache.iceberg.hadoop.HadoopCatalog\\\")\\r\\n    .config(f\\\"spark.sql.catalog.{catalog_name}.warehouse\\\", warehouse_path)\\r\\n    .config(\\\"spark.hadoop.fs.s3a.aws.credentials.provider\\\", \\\"com.amazonaws.auth.DefaultAWSCredentialsProviderChain\\\")\\r\\n    .getOrCreate()\\r\\n)\\r\\n\\r\\n# â Read table directly\\r\\ntable_path \\u003d f\\\"{catalog_name}.{database_name}.{table_name}\\\"\\r\\nspark.read.table(table_path).show()\\r\\nspark.sql(\\\"SHOW CATALOGS\\\").show()\\r\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"hideDatasets\":\"N\",\"componentId\":3,\"componentName\":\"Code 3\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"type\":\"static\",\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":3,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow","workSchemaName":null,"diagramSchema":"{\"isCustom\":false,\"diagramDef\":[]}"},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[],"filterDatasetMappings":[],"referenceDatasets":"{\"2\":[]}"}